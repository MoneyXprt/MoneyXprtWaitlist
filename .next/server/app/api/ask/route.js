"use strict";(()=>{var e={};e.id=570,e.ids=[570],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9646:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>m,patchFetch:()=>g,requestAsyncStorage:()=>u,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>h});var i={};a.r(i),a.d(i,{POST:()=>d});var r=a(9303),n=a(8716),s=a(3131),o=a(7070),l=a(1528);async function d(e){let{input:t,question:a}=await e.json(),i=process.env.OPENAI_API_KEY,r=(0,l.Wq)(t),n=(0,l.Nt)(t);if(!i)return o.NextResponse.json({answer:"AI follow-ups are disabled (no API key). Here’s context you can use:\n"+JSON.stringify({snapshot:n,bullets:r},null,2)});let s=[{role:"system",content:"You are a fiduciary-quality financial & tax planner. Be specific, concise, actionable. Use only the provided context; do not request SSNs or sensitive identifiers."},{role:"user",content:`USER QUESTION: ${a}

CURRENT CONTEXT (JSON):
${JSON.stringify({input:t,snapshot:n,bullets:r},null,2)}

Answer directly in 1–3 short sections with numbered steps where helpful.`}],d=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({model:"gpt-4o-mini",messages:s,temperature:.2})}),c=await d.json(),u=c?.choices?.[0]?.message?.content??"Sorry, I could not generate an answer.";return o.NextResponse.json({answer:u})}let c=new r.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/ask/route",pathname:"/api/ask",filename:"route",bundlePath:"app/api/ask/route"},resolvedPagePath:"/Users/ianjoachim/Documents/GitHub/MoneyXprt/app/api/ask/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:u,staticGenerationAsyncStorage:h,serverHooks:p}=c,m="/api/ask/route";function g(){return(0,s.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:h})}},1528:(e,t,a)=>{a.d(t,{Nt:()=>o,Wq:()=>l});let i=e=>"number"==typeof e&&isFinite(e)?e:0,r=(...e)=>e.reduce((e,t)=>e+i(t),0),n=e=>e.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),s={single:14600,married_joint:29200,married_separate:14600,head:21900};function o(e){let t=r(e.salary,e.bonus,e.selfEmployment,e.rsuVesting,e.k1Active,e.k1Passive,e.otherIncome,e.rentNOI),a=12*i(e.fixedMonthlySpend)+12*i(e.lifestyleMonthlySpend),n=Math.max(0,t-a),s=(e.properties||[]).reduce((e,t)=>e+(i(t.estimatedValue)-i(t.mortgageBalance)),0),o=i(e.alts?.privateEquityVC)+i(e.alts?.collectibles)+i(e.alts?.other),l=r(e.cash,e.brokerage,e.retirement,e.hsa,e.crypto,s,o),d=r(e.mortgageDebt,e.studentLoans,e.autoLoans,e.creditCards,e.otherDebt),c=Math.max(3,i(e.emergencyFundMonths)),u=Math.max(1e3,i(e.fixedMonthlySpend)+i(e.lifestyleMonthlySpend)),h=u*c,p=u>0?i(e.cash)/u:0,m=h>0?Math.min(100,i(e.cash)/h*100):0;return{grossIncome:t,spendAnnual:a,impliedSavings:n,savingsRate:t>0?n/t*100:0,totalAssets:l,totalDebts:d,netWorth:l-d,ef:{targetEFMonths:c,monthlyBurn:u,efTarget:h,efCoverageMonths:p,efPct:m}}}function l(e){let t=e.discovery||{},a=(Array.isArray(e.goals5y)?e.goals5y:t.goals5)||[],r=(Array.isArray(e.goals20y)?e.goals20y:t.goals20)||[],l=e.freedomDef??t.freedom??"",d=Number.isFinite(e.confidence)?e.confidence:t.confidence??5,{grossIncome:c,spendAnnual:u,impliedSavings:h,savingsRate:p,netWorth:m}=o(e),g=s[e.filingStatus]??s.single,y=!!e.itemizeLikely,f=c>23e4&&"married_joint"===e.filingStatus||c>146e3&&"married_joint"!==e.filingStatus,b=[d>=8?"You’re confident—lean into compounding, while covering tail risks.":d<=4?"Since confidence is lower, bias to liquidity and resilience as we build momentum.":"Solid. We’ll balance growth with safety and cash flexibility.",`Snapshot: income ${n(c)}/yr; spend ${n(u)}/yr ⇒ implied savings ${n(h)} (${Math.round(p)}%). Net worth ${n(m)}.`],{ef:v}=o(e),x=Math.max(0,v.efTarget-i(e.cash));if(x>0?b.push(`Raise emergency fund to ~${v.targetEFMonths} months (${n(v.efTarget)}). Autotransfer ~${n(Math.ceil(x/12))}/mo to HYSA/T-bills.`):b.push(`Emergency fund ok (~${v.targetEFMonths} months). Keep it in HYSA/T-bill ladder for yield without losing liquidity.`),p<20){let e=Math.ceil((.2*c-h)/12);b.push(e>0?`Increase savings rate toward 20–30%: bump automated transfers by ~${n(e)}/mo (pay-yourself-first).`:`Increase savings rate toward 20–30% via automatic bumps after raises/bonuses.`)}else p>=30&&b.push(`Excellent savings discipline (~${Math.round(p)}%). Set a 1% auto-increase each year.`);let S=Math.max(0,23e3-Math.min(23e3,i(e.retirement)));if(S>0&&b.push(`If not already maxing, target employee 401(k) limit (~${n(23e3)}). Increase payroll deferrals by ~${n(Math.ceil(S/12))}/mo.`),b.push("Max tax-advantaged space: 401(k)/403(b), IRA/backdoor Roth (if needed), HSA if eligible."),f&&!e.usingRothBackdoor&&b.push("Income likely above direct Roth limits; consider a backdoor Roth (watch the pro-rata rule)."),e.usingMegaBackdoor&&b.push(`Using a mega-backdoor Roth—great. Confirm plan rules and avoid after-tax leakage.`),i(e.rsuVesting)>0){let t=.12999999999999998*i(e.rsuVesting);b.push(t>0?`RSUs: plans often withhold ~${Math.round(22)}%. At your bracket, set aside ~${n(t)} more across vests. Consider 10b5-1 and diversify concentration.`:"RSUs: verify withholding and consider a 10b5-1/diversify plan to manage risk and taxes.")}if(e.creditCards>0&&b.push("Attack credit cards first (avalanche). Automate extra above minimums until paid off."),e.studentLoans+e.autoLoans>0&&b.push("After high-interest debt, target student/auto loans while keeping retirement contributions on track."),b.push("If mortgage rate > your safe after-tax yield, add modest extra principal payments after savings goals are met."),(y||e.charitableInclination)&&b.push(`Itemized vs standard: compare to ~${n(g)} annually (SALT cap applies). Consider charitable “bunching” or a DAF in high-income years.`),e.hasDisability||b.push("Add long-term disability insurance (top income-protection priority)."),e.hasTermLife||b.push(`If others rely on your income, add term life (often 20–30\xd7 annual expenses).`),e.hasUmbrella||b.push(`Add a $1–$2M umbrella liability policy; it’s inexpensive and high impact.`),e.concentrationRisk&&b.push("Reduce concentration risk via target weights and scheduled auto-sells on any excess."),e.targetRetireIncomeMonthly>0){let t=12*i(e.targetRetireIncomeMonthly);b.push(`Retirement income target ~${n(t)}/yr ⇒ long-run portfolio ~${n(t/.04)} (4% proxy). Adjust for pensions, rentals, or early retirement.`)}e.hasWillOrTrust?b.push(`Review will/trust every 3–5 years and after major life events. Add POA/healthcare directives.`):b.push("Create a will and (if appropriate) a revocable living trust. Add POA/healthcare directives.");let A=a.filter(Boolean).slice(0,3),k=r.filter(Boolean).slice(0,3);return A.length&&b.push(`Near-term goals: ${A.join(" \xb7 ")}.`),k.length&&b.push(`Long-term goals: ${k.join(" \xb7 ")}.`),l&&b.push(`“Financial freedom” (your words): ${l}`),b.push("Set a 12-month roadmap: automate transfers, schedule quarterly reviews, and rebalance annually."),b}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),i=t.X(0,[948,972],()=>a(9646));module.exports=i})();