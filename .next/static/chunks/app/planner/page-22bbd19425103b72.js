(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[136],{8546:function(e,t,s){Promise.resolve().then(s.bind(s,4955))},4955:function(e,t,s){"use strict";s.d(t,{default:function(){return ei}});var a=s(7437),l=s(2265);let n={firstName:"",lastName:"",email:"",state:"",residency:[],salary:0,bonus:0,selfEmployment:0,rsuVesting:0,k1Active:0,k1Passive:0,otherIncome:0,rentNOI:0,fixedMonthlySpend:0,lifestyleMonthlySpend:0,savingsMonthly:0,cash:0,brokerage:0,retirement:0,hsa:0,crypto:0,properties:[],alts:{privateEquityVC:0,collectibles:0,other:0},mortgageDebt:0,studentLoans:0,autoLoans:0,creditCards:0,otherDebt:0,filingStatus:"single",itemizeLikely:!1,charitableInclination:!1,entityOrSideBiz:!1,hasDisability:!1,hasTermLife:!1,hasUmbrella:!1,hasWillOrTrust:!1,hasPensionOrDeferredComp:!1,expectsInheritance:!1,givingIntent:!1,emergencyFundMonths:3,targetRetireIncomeMonthly:0,targetRetireAge:65,usingRothBackdoor:!1,usingMegaBackdoor:!1,concentrationRisk:!1,discovery:void 0,goals5y:[],goals20y:[],freedomDef:"",confidence:5,w2BaseAnnual:0,bonusPlanAnnual:0,bonusYTD:0,rsu:{eligible:!1,ticker:"",ytdVestedValue:0,yearVestingTotal:0,schedule:[]},espp:{eligible:!1,discountPercent:0,contributionPercent:0,purchaseMonths:[]},deferredComp:{eligible:!1},deferred:[]},i=["single","married_joint","married_separate","head"];function r(e){var t,s,l,n,r,d;let{value:c,onChange:u,onNext:h,onBack:m}=e,p=e=>u({...c,...e}),x=(e,t)=>{var s,a;let l=[...null!==(s=c.residency)&&void 0!==s?s:[]],n=null!==(a=l[e])&&void 0!==a?a:{state:"",startDate:""};l[e]={...n,...t},p({residency:l})},g=e=>{var t;let s=[...null!==(t=c.residency)&&void 0!==t?t:[]];s.splice(e,1),p({residency:s})},b=(e,t)=>{var s;let a=(null!==(s=c.residency)&&void 0!==s?s:[]).map((s,a)=>({...s,primary:t&&a===e}));p({residency:a});let l=a[e];t&&(null==l?void 0:l.state)&&p({state:l.state})};return(0,a.jsxs)("section",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Profile & Residency"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Light profile (no sensitive PII). Residency helps the 50-state tax engine pick the right rules."}),(0,a.jsxs)("div",{className:"rounded border p-4 grid md:grid-cols-3 gap-4",children:[(0,a.jsx)(o,{label:"First name (optional)",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"text",value:null!==(t=c.firstName)&&void 0!==t?t:"",onChange:e=>p({firstName:e.target.value}),placeholder:"e.g., Alex"})}),(0,a.jsx)(o,{label:"Last name (optional)",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"text",value:null!==(s=c.lastName)&&void 0!==s?s:"",onChange:e=>p({lastName:e.target.value}),placeholder:"e.g., Morgan"})}),(0,a.jsx)(o,{label:"Email (optional)",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"email",value:null!==(l=c.email)&&void 0!==l?l:"",onChange:e=>p({email:e.target.value}),placeholder:"you@example.com"})}),(0,a.jsx)(o,{label:"Filing status",children:(0,a.jsx)("select",{className:"w-full border rounded px-3 py-2",value:c.filingStatus,onChange:e=>p({filingStatus:e.target.value}),children:i.map(e=>(0,a.jsx)("option",{value:e,children:function(e){switch(e){case"single":return"Single";case"married_joint":return"Married filing jointly";case"married_separate":return"Married filing separately";case"head":return"Head of household";default:return e}}(e)},e))})}),(0,a.jsxs)(o,{label:"Domicile / current state",children:[(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"text",value:null!==(n=c.state)&&void 0!==n?n:"",onChange:e=>p({state:e.target.value}),placeholder:"e.g., CA, NY, TX"}),(0,a.jsxs)("p",{className:"text-[12px] text-gray-500 mt-1",children:["This mirrors the row you mark as ",(0,a.jsx)("em",{children:"Primary"})," in the residency list below."]})]})]}),(0,a.jsxs)("div",{className:"rounded border p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Residency history (this tax year)"}),(0,a.jsx)("button",{type:"button",className:"text-sm rounded border px-3 py-1 hover:bg-gray-50",onClick:()=>{var e;p({residency:[...null!==(e=c.residency)&&void 0!==e?e:[],{state:"",startDate:"",endDate:"",primary:!1}]})},children:"+ Add state period"})]}),0===(null!==(r=c.residency)&&void 0!==r?r:[]).length?(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Add any states you lived in this year (helpful for part-year / multi-state filing)."}):(0,a.jsx)("div",{className:"space-y-3",children:(null!==(d=c.residency)&&void 0!==d?d:[]).map((e,t)=>{var s,l,n;return(0,a.jsxs)("div",{className:"grid md:grid-cols-5 gap-3 items-end border rounded p-3",children:[(0,a.jsx)(o,{label:"State",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",value:null!==(s=e.state)&&void 0!==s?s:"",onChange:e=>x(t,{state:e.target.value}),placeholder:"e.g., CA"})}),(0,a.jsx)(o,{label:"Start date",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"date",value:null!==(l=e.startDate)&&void 0!==l?l:"",onChange:e=>x(t,{startDate:e.target.value})})}),(0,a.jsx)(o,{label:"End date (optional)",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",type:"date",value:null!==(n=e.endDate)&&void 0!==n?n:"",onChange:e=>x(t,{endDate:e.target.value})})}),(0,a.jsx)(o,{label:"Primary?",children:(0,a.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:String(!!e.primary),onChange:e=>b(t,"true"===e.target.value),children:[(0,a.jsx)("option",{value:"false",children:"No"}),(0,a.jsx)("option",{value:"true",children:"Yes"})]})}),(0,a.jsx)("div",{className:"flex md:justify-end",children:(0,a.jsx)("button",{type:"button",className:"text-sm rounded border px-3 py-2 hover:bg-gray-50",onClick:()=>g(t),children:"Remove"})})]},t)})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("button",{type:"button",className:"rounded border px-4 py-2",onClick:m,children:"Back"}),(0,a.jsx)("button",{type:"button",className:"inline-flex px-4 py-2 rounded bg-black text-white",onClick:h,children:"Continue"})]})]})}function o(e){let{label:t,children:s}=e;return(0,a.jsxs)("label",{className:"block text-sm",children:[(0,a.jsx)("span",{className:"block font-medium mb-1",children:t}),s]})}let d=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}];function c(e){var t,s,l,n,i;let{value:r,onChange:o,onNext:c,onBack:x}=e,g=e=>o({...r,...e}),b=null!==(t=r.deferredComp)&&void 0!==t?t:{eligible:!1,electedPercent:0},y=null!==(s=r.rsu)&&void 0!==s?s:{yearVestingTotal:0},v=null!==(l=r.espp)&&void 0!==l?l:{eligible:!1},j=Number(r.bonus)||0,f=Number(r.bonusYTD)||0,N=Math.max(0,j-f);return(0,a.jsxs)("section",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Compensation (Full-Year & YTD)"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Enter full-year expected amounts and what’s happened year-to-date. We’ll use this to generate mid-year actions (e.g., bonus planning)."}),(0,a.jsxs)("div",{className:"rounded border p-4 space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium",children:"W-2 & Cash Bonuses"}),(0,a.jsx)(u,{label:"W-2 Base salary (annual)",tip:"Your base pay before bonuses.",children:(0,a.jsx)(m,{value:Number(r.salary)||0,onChange:e=>g({salary:e})})}),(0,a.jsx)(u,{label:"Cash bonuses (annual plan)",tip:"Total expected cash bonuses this year (sign-on, performance, retention).",children:(0,a.jsx)(m,{value:j,onChange:e=>g({bonus:e})})}),(0,a.jsx)(u,{label:"Cash bonuses (YTD received)",tip:"Cash bonuses already received this year.",children:(0,a.jsx)(m,{value:f,onChange:e=>g({bonusYTD:e})})}),(0,a.jsxs)(h,{children:["Planned: $",j.toLocaleString()," \xb7 YTD: $",f.toLocaleString()," \xb7 Remaining: $",N.toLocaleString()]})]}),(0,a.jsxs)("div",{className:"rounded border p-4 space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Deferred Compensation"}),(0,a.jsx)(u,{label:"Eligible?",tip:"Plans that let you defer current income to a future payout (reduces current taxable income).",children:(0,a.jsx)(p,{value:!!b.eligible,onChange:e=>g({deferredComp:{...b,eligible:e}})})}),!!b.eligible&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{label:"Elected % of eligible pay",children:(0,a.jsx)(m,{value:Number(b.electedPercent)||0,onChange:e=>g({deferredComp:{...b,electedPercent:e,eligible:!0}})})}),(0,a.jsx)(u,{label:"Company match % (if any)",children:(0,a.jsx)(m,{value:Number(b.companyMatchPercent)||0,onChange:e=>g({deferredComp:{...b,companyMatchPercent:e}})})}),(0,a.jsx)(u,{label:"Distribution style",children:(0,a.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:null!==(n=b.distribution)&&void 0!==n?n:"",onChange:e=>g({deferredComp:{...b,distribution:e.target.value||void 0}}),children:[(0,a.jsx)("option",{value:"",children:"Select…"}),(0,a.jsx)("option",{value:"lump",children:"Lump sum"}),(0,a.jsx)("option",{value:"schedule",children:"Installments / schedule"})]})}),(0,a.jsx)(u,{label:"First payout year (if known)",children:(0,a.jsx)(m,{value:Number(b.firstPayoutYear)||0,onChange:e=>g({deferredComp:{...b,firstPayoutYear:e||void 0}})})})]})]}),(0,a.jsxs)("div",{className:"rounded border p-4 space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Equity — RSU & ESPP"}),(0,a.jsx)(u,{label:"RSU eligible?",tip:"RSU = Restricted Stock Units (taxed as they vest).",children:(0,a.jsx)(p,{value:!!y.eligible,onChange:e=>g({rsu:{...y,eligible:e,yearVestingTotal:y.yearVestingTotal}})})}),!!y.eligible&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{label:"Company ticker (optional)",children:(0,a.jsx)("input",{className:"w-full border rounded px-3 py-2",placeholder:"e.g., AAPL",value:null!==(i=y.ticker)&&void 0!==i?i:"",onChange:e=>g({rsu:{...y,ticker:e.target.value.toUpperCase(),yearVestingTotal:y.yearVestingTotal}})})}),(0,a.jsx)(u,{label:"RSU vesting (YTD $)",children:(0,a.jsx)(m,{value:Number(y.ytdVestedValue)||0,onChange:e=>g({rsu:{...y,ytdVestedValue:e,yearVestingTotal:y.yearVestingTotal}})})}),(0,a.jsx)(u,{label:"RSU vesting (expected total this year $)",children:(0,a.jsx)(m,{value:Number(y.yearVestingTotal)||0,onChange:e=>g({rsuVesting:e,rsu:{...y,yearVestingTotal:e}})})})]}),(0,a.jsx)(u,{label:"ESPP eligible?",tip:"ESPP = Employee Stock Purchase Plan; buy company stock via payroll at a discount.",children:(0,a.jsx)(p,{value:!!v.eligible,onChange:e=>g({espp:{...v,eligible:e}})})}),!!v.eligible&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{label:"Discount %",children:(0,a.jsx)(m,{value:Number(v.discountPercent)||0,onChange:e=>g({espp:{...v,discountPercent:e,eligible:v.eligible}})})}),(0,a.jsx)(u,{label:"Contribution % (payroll)",children:(0,a.jsx)(m,{value:Number(v.contributionPercent)||0,onChange:e=>g({espp:{...v,contributionPercent:e,eligible:v.eligible}})})}),(0,a.jsx)(u,{label:"Purchase months",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map(e=>{let{label:t,value:s}=e,l=!!Array.isArray(v.purchaseMonths)&&v.purchaseMonths.includes(s);return(0,a.jsx)("button",{type:"button",className:"px-2 py-1 rounded border text-sm ".concat(l?"bg-black text-white":""),onClick:()=>{let e=new Set(Array.isArray(v.purchaseMonths)?v.purchaseMonths:[]);e.has(s)?e.delete(s):e.add(s),g({espp:{...v,purchaseMonths:Array.from(e)}})},children:t},s)})})})]})]}),(0,a.jsxs)("div",{className:"rounded border p-4 space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Other Income"}),(0,a.jsx)(u,{label:"Self-employment (annual)",children:(0,a.jsx)(m,{value:Number(r.selfEmployment)||0,onChange:e=>g({selfEmployment:e})})}),(0,a.jsx)(u,{label:"K-1 (active)",children:(0,a.jsx)(m,{value:Number(r.k1Active)||0,onChange:e=>g({k1Active:e})})}),(0,a.jsx)(u,{label:"K-1 (passive)",children:(0,a.jsx)(m,{value:Number(r.k1Passive)||0,onChange:e=>g({k1Passive:e})})}),(0,a.jsx)(u,{label:"Other income (interest/dividends, annual)",children:(0,a.jsx)(m,{value:Number(r.otherIncome)||0,onChange:e=>g({otherIncome:e})})}),(0,a.jsx)(u,{label:"Rental NOI (annual)",tip:"Net operating income from rentals (income minus operating expenses).",children:(0,a.jsx)(m,{value:Number(r.rentNOI)||0,onChange:e=>g({rentNOI:e})})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("button",{type:"button",className:"rounded border px-4 py-2",onClick:x,children:"Back"}),(0,a.jsx)("button",{type:"button",className:"inline-flex px-4 py-2 rounded bg-black text-white",onClick:c,children:"Continue"})]})]})}function u(e){let{label:t,tip:s,children:l}=e;return(0,a.jsxs)("label",{className:"block text-sm",children:[(0,a.jsxs)("span",{className:"block font-medium mb-1",children:[t," ",s&&(0,a.jsxs)("span",{className:"ml-2 text-gray-500",children:["(",s,")"]})]}),l]})}function h(e){let{children:t}=e;return(0,a.jsx)("p",{className:"text-xs text-gray-600",children:t})}function m(e){let{value:t,onChange:s}=e;return(0,a.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:Number.isFinite(t)?t:"",onChange:e=>{let t=""===e.target.value?0:parseFloat(e.target.value);s(Number.isNaN(t)?0:t)}})}function p(e){let{value:t,onChange:s}=e;return(0,a.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:String(t),onChange:e=>s("true"===e.target.value),children:[(0,a.jsx)("option",{value:"false",children:"No"}),(0,a.jsx)("option",{value:"true",children:"Yes"})]})}let x=e=>"number"==typeof e&&isFinite(e)?e:0;function g(e){let{value:t,onChange:s,onNext:n,onBack:i}=e;(0,l.useId)();let r=(e,a)=>s({...t,[e]:a});return(0,a.jsxs)("section",{className:"rounded border p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Step 2 — Cash flow & income"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Ballpark is fine. This powers tax and savings recommendations."}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsx)(b,{label:"Salary (W-2) – yearly",val:x(t.salary),set:e=>r("salary",e)}),(0,a.jsx)(b,{label:"Bonus – yearly",val:x(t.bonus),set:e=>r("bonus",e)}),(0,a.jsx)(b,{label:"Self-employment net – yearly",val:x(t.selfEmployment),set:e=>r("selfEmployment",e)}),(0,a.jsx)(b,{label:"RSU vesting – yearly",val:x(t.rsuVesting),set:e=>r("rsuVesting",e)}),(0,a.jsx)(b,{label:"K-1 ordinary (active) – yearly",val:x(t.k1Active),set:e=>r("k1Active",e)}),(0,a.jsx)(b,{label:"K-1 ordinary (passive) – yearly",val:x(t.k1Passive),set:e=>r("k1Passive",e)}),(0,a.jsx)(b,{label:"Rental NOI – yearly",val:x(t.rentNOI),set:e=>r("rentNOI",e)}),(0,a.jsx)(b,{label:"Other income – yearly",val:x(t.otherIncome),set:e=>r("otherIncome",e)})]}),(0,a.jsx)("h3",{className:"font-medium mt-6 mb-2",children:"Monthly spending & savings"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsx)(b,{label:"Fixed expenses / mo",val:x(t.fixedMonthlySpend),set:e=>r("fixedMonthlySpend",e)}),(0,a.jsx)(b,{label:"Lifestyle extras / mo",val:x(t.lifestyleMonthlySpend),set:e=>r("lifestyleMonthlySpend",e)}),(0,a.jsx)(b,{label:"Savings already / mo",val:x(t.savingsMonthly),set:e=>r("savingsMonthly",e)})]}),(0,a.jsx)(y,{onBack:i,onNext:n})]})}function b(e){let{label:t,val:s,set:l}=e;return(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm mb-1",children:t}),(0,a.jsx)("input",{type:"number",inputMode:"decimal",className:"w-full border rounded px-3 py-2",value:x(s),onChange:e=>{let t=parseFloat(e.target.value||"0");l(isFinite(t)?t:0)}})]})}function y(e){let{onBack:t,onNext:s}=e;return(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsx)("button",{type:"button",onClick:t,className:"rounded border px-3 py-2",children:"Back"}),(0,a.jsx)("button",{type:"button",onClick:s,className:"rounded bg-black text-white px-4 py-2",children:"Continue"})]})}let v=e=>"number"==typeof e&&isFinite(e)?Number(e):0;function j(e){var t,s,l,n,i,r;let{value:o,onChange:d,onNext:c,onBack:u}=e,h=(e,t)=>d({...o,[e]:t}),m=(e,t)=>{h("properties",o.properties.map(s=>s.id===e?{...s,...t}:s))},p=e=>{h("properties",o.properties.filter(t=>t.id!==e))},x=o.properties.reduce((e,t)=>e+(v(t.estimatedValue)-v(t.mortgageBalance)),0),g=v(null===(t=o.alts)||void 0===t?void 0:t.privateEquityVC)+v(null===(s=o.alts)||void 0===s?void 0:s.collectibles)+v(null===(l=o.alts)||void 0===l?void 0:l.other);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Balance Sheet"}),(0,a.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,a.jsx)(f,{label:"Cash (HYSA)",v:o.cash,set:e=>h("cash",e)}),(0,a.jsx)(f,{label:"Brokerage (taxable)",v:o.brokerage,set:e=>h("brokerage",e)}),(0,a.jsx)(f,{label:"Retirement (401k/IRA/Roth)",v:o.retirement,set:e=>h("retirement",e)}),(0,a.jsx)(f,{label:"HSA",v:o.hsa,set:e=>h("hsa",e)}),(0,a.jsx)(f,{label:"Crypto",v:o.crypto,set:e=>h("crypto",e)})]}),(0,a.jsxs)("div",{className:"rounded border",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3",children:[(0,a.jsx)("div",{className:"font-medium",children:"Properties & Real Estate"}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e={id:String(Date.now()),nickname:"",use:"primary_home",estimatedValue:0,mortgageBalance:0,interestRate:void 0,monthlyRent:void 0,monthlyCosts:void 0,state:""};h("properties",[...o.properties,e])},className:"px-3 py-1 rounded border hover:bg-gray-50 text-sm",children:"+ Add property"})]}),(0,a.jsx)("div",{className:"border-t",children:0===o.properties.length?(0,a.jsx)("div",{className:"p-3 text-sm text-gray-600",children:"No properties yet. Add your home, rentals, or land."}):(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"[&>th]:px-3 [&>th]:py-2 text-left",children:[(0,a.jsx)("th",{children:"Nickname"}),(0,a.jsx)("th",{children:"Use"}),(0,a.jsx)("th",{children:"State"}),(0,a.jsx)("th",{children:"Est. value"}),(0,a.jsx)("th",{children:"Mortgage bal."}),(0,a.jsx)("th",{children:"Rate"}),(0,a.jsx)("th",{children:"Rent/mo"}),(0,a.jsx)("th",{children:"Costs/mo"}),(0,a.jsx)("th",{children:"Equity"}),(0,a.jsx)("th",{})]})}),(0,a.jsxs)("tbody",{children:[o.properties.map(e=>{var t,s,l,n,i;let r=v(e.estimatedValue)-v(e.mortgageBalance);return(0,a.jsxs)("tr",{className:"[&>td]:px-3 [&>td]:py-2 border-t",children:[(0,a.jsx)("td",{children:(0,a.jsx)("input",{className:"border rounded px-2 py-1 w-40",value:null!==(t=e.nickname)&&void 0!==t?t:"",onChange:t=>m(e.id,{nickname:t.target.value})})}),(0,a.jsx)("td",{children:(0,a.jsxs)("select",{className:"border rounded px-2 py-1",value:e.use,onChange:t=>m(e.id,{use:t.target.value}),children:[(0,a.jsx)("option",{value:"primary_home",children:"Primary"}),(0,a.jsx)("option",{value:"second_home",children:"Second home"}),(0,a.jsx)("option",{value:"rental",children:"Rental"}),(0,a.jsx)("option",{value:"land",children:"Land"})]})}),(0,a.jsx)("td",{children:(0,a.jsx)("input",{className:"border rounded px-2 py-1 w-24",placeholder:"e.g., CA",value:null!==(s=e.state)&&void 0!==s?s:"",onChange:t=>m(e.id,{state:t.target.value})})}),(0,a.jsx)("td",{children:(0,a.jsx)(N,{value:e.estimatedValue,onChange:t=>m(e.id,{estimatedValue:t})})}),(0,a.jsx)("td",{children:(0,a.jsx)(N,{value:e.mortgageBalance,onChange:t=>m(e.id,{mortgageBalance:t})})}),(0,a.jsx)("td",{children:(0,a.jsx)(N,{value:null!==(l=e.interestRate)&&void 0!==l?l:0,onChange:t=>m(e.id,{interestRate:t})})}),(0,a.jsx)("td",{children:(0,a.jsx)(N,{value:null!==(n=e.monthlyRent)&&void 0!==n?n:0,onChange:t=>m(e.id,{monthlyRent:t})})}),(0,a.jsx)("td",{children:(0,a.jsx)(N,{value:null!==(i=e.monthlyCosts)&&void 0!==i?i:0,onChange:t=>m(e.id,{monthlyCosts:t})})}),(0,a.jsx)("td",{children:k(r)}),(0,a.jsx)("td",{children:(0,a.jsx)("button",{type:"button",onClick:()=>p(e.id),className:"text-red-600 hover:underline",children:"Remove"})})]},e.id)}),(0,a.jsxs)("tr",{className:"[&>td]:px-3 [&>td]:py-2 border-t font-medium",children:[(0,a.jsx)("td",{colSpan:8,className:"text-right",children:"Total property equity"}),(0,a.jsx)("td",{children:k(x)}),(0,a.jsx)("td",{})]})]})]})})]}),(0,a.jsxs)("div",{className:"rounded border p-4",children:[(0,a.jsx)("div",{className:"font-medium mb-3",children:"Other / Alternative Assets (optional)"}),(0,a.jsxs)("div",{className:"grid sm:grid-cols-3 gap-4",children:[(0,a.jsx)(f,{label:"Private Equity / VC",v:v(null===(n=o.alts)||void 0===n?void 0:n.privateEquityVC),set:e=>h("alts",{...o.alts,privateEquityVC:e})}),(0,a.jsx)(f,{label:"Collectibles",v:v(null===(i=o.alts)||void 0===i?void 0:i.collectibles),set:e=>h("alts",{...o.alts,collectibles:e})}),(0,a.jsx)(f,{label:"Other",v:v(null===(r=o.alts)||void 0===r?void 0:r.other),set:e=>h("alts",{...o.alts,other:e})})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 mt-2",children:["Alt total: ",k(g)]})]}),(0,a.jsxs)("div",{className:"rounded border p-4",children:[(0,a.jsx)("div",{className:"font-medium mb-3",children:"Debts (non-property)"}),(0,a.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,a.jsx)(f,{label:"Mortgage debt (other, if any)",v:o.mortgageDebt,set:e=>h("mortgageDebt",e)}),(0,a.jsx)(f,{label:"Student loans",v:o.studentLoans,set:e=>h("studentLoans",e)}),(0,a.jsx)(f,{label:"Auto loans",v:o.autoLoans,set:e=>h("autoLoans",e)}),(0,a.jsx)(f,{label:"Credit cards",v:o.creditCards,set:e=>h("creditCards",e)}),(0,a.jsx)(f,{label:"Other debt",v:o.otherDebt,set:e=>h("otherDebt",e)})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:u,className:"rounded border px-4 py-2 hover:bg-gray-50",children:"Back"}),(0,a.jsx)("button",{type:"button",onClick:c,className:"rounded bg-black text-white px-4 py-2 hover:opacity-90",children:"Next"})]})]})}function f(e){let{label:t,v:s,set:l}=e;return(0,a.jsxs)("label",{className:"text-sm block",children:[(0,a.jsx)("span",{className:"block text-[12px] text-gray-600 mb-1",children:t}),(0,a.jsx)("input",{type:"number",className:"w-full border rounded px-2 py-1",value:Number.isFinite(s)?s:0,onChange:e=>l(parseFloat(e.target.value||"0"))})]})}function N(e){let{value:t,onChange:s}=e;return(0,a.jsx)("input",{type:"number",className:"w-28 border rounded px-2 py-1",value:Number.isFinite(t)?t:0,onChange:e=>s(parseFloat(e.target.value||"0"))})}function k(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0})}let C=["AL","AK","AZ","AR","CA","CO","CT","DC","DE","FL","GA","HI","IA","ID","IL","IN","KS","KY","LA","MA","MD","ME","MI","MN","MO","MS","MT","NC","ND","NE","NH","NJ","NM","NV","NY","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VA","VT","WA","WI","WV","WY"];function S(e){let{value:t,onChange:s,onNext:l,onBack:n}=e,i=(e,a)=>s({...t,[e]:a});return(0,a.jsxs)("section",{className:"rounded border p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Step 4 — Taxes (just the essentials)"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"No SSNs or filings needed—just planning inputs."}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm mb-1",children:"Filing status"}),(0,a.jsxs)("select",{className:"w-full border rounded px-3 py-2",value:t.filingStatus,onChange:e=>i("filingStatus",e.target.value),children:[(0,a.jsx)("option",{value:"single",children:"Single"}),(0,a.jsx)("option",{value:"married_joint",children:"Married filing jointly"}),(0,a.jsx)("option",{value:"married_separate",children:"Married filing separately"}),(0,a.jsx)("option",{value:"head",children:"Head of household"})]})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm mb-1",children:"State"}),(0,a.jsx)("select",{className:"w-full border rounded px-3 py-2",value:t.state,onChange:e=>i("state",e.target.value),children:C.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsx)(w,{label:"Likely to itemize deductions",v:t.itemizeLikely,set:e=>i("itemizeLikely",e)}),(0,a.jsx)(w,{label:"Charitable giving likely this year",v:t.charitableInclination,set:e=>i("charitableInclination",e)}),(0,a.jsx)(w,{label:"Have side-biz or consider entity optimization",v:t.entityOrSideBiz,set:e=>i("entityOrSideBiz",e)})]}),(0,a.jsx)(M,{onBack:n,onNext:l})]})}function w(e){let{label:t,v:s,set:l}=e;return(0,a.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:s,onChange:e=>l(e.target.checked)}),(0,a.jsx)("span",{children:t})]})}function M(e){let{onBack:t,onNext:s}=e;return(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsx)("button",{type:"button",className:"rounded border px-3 py-2",onClick:t,children:"Back"}),(0,a.jsx)("button",{type:"button",className:"rounded bg-black text-white px-4 py-2",onClick:s,children:"Continue"})]})}let R=e=>"number"==typeof e&&isFinite(e)?e:0;function A(e){let{value:t,onChange:s,onNext:l,onBack:n}=e,i=(e,a)=>s({...t,[e]:a});return(0,a.jsxs)("section",{className:"rounded border p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Step 5 — Retirement & wealth building"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsx)(D,{label:"Target retire age",v:R(t.targetRetireAge),set:e=>i("targetRetireAge",e)}),(0,a.jsx)(D,{label:"Desired retirement income / mo",v:R(t.targetRetireIncomeMonthly),set:e=>i("targetRetireIncomeMonthly",e)}),(0,a.jsx)(T,{label:"Using backdoor Roth",v:t.usingRothBackdoor,set:e=>i("usingRothBackdoor",e)}),(0,a.jsx)(T,{label:"Using mega backdoor Roth",v:t.usingMegaBackdoor,set:e=>i("usingMegaBackdoor",e)}),(0,a.jsx)(T,{label:"Have pension or deferred comp",v:t.hasPensionOrDeferredComp,set:e=>i("hasPensionOrDeferredComp",e)})]}),(0,a.jsx)(I,{onBack:n,onNext:l})]})}function D(e){let{label:t,v:s,set:l}=e;return(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm mb-1",children:t}),(0,a.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:R(s),onChange:e=>{let t=parseFloat(e.target.value||"0");l(isFinite(t)?t:0)}})]})}function T(e){let{label:t,v:s,set:l}=e;return(0,a.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:s,onChange:e=>l(e.target.checked)}),(0,a.jsx)("span",{children:t})]})}function I(e){let{onBack:t,onNext:s}=e;return(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsx)("button",{type:"button",className:"rounded border px-3 py-2",onClick:t,children:"Back"}),(0,a.jsx)("button",{type:"button",className:"rounded bg-black text-white px-4 py-2",onClick:s,children:"Continue"})]})}function F(e){let{value:t,onChange:s,onNext:l,onBack:n}=e,i=(e,a)=>s({...t,[e]:a});return(0,a.jsxs)("section",{className:"rounded border p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Step 6 — Risk & protection"}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsx)(P,{label:"Emergency fund (months)",v:t.emergencyFundMonths,set:e=>i("emergencyFundMonths",e)}),(0,a.jsx)(L,{label:"Term life insurance in place",v:t.hasTermLife,set:e=>i("hasTermLife",e)}),(0,a.jsx)(L,{label:"Long-term disability insurance",v:t.hasDisability,set:e=>i("hasDisability",e)}),(0,a.jsx)(L,{label:"Umbrella liability policy",v:t.hasUmbrella,set:e=>i("hasUmbrella",e)}),(0,a.jsx)(L,{label:"Concentration risk (single stock/asset)",v:t.concentrationRisk,set:e=>i("concentrationRisk",e)})]}),(0,a.jsx)(E,{onBack:n,onNext:l})]})}function P(e){let{label:t,v:s,set:l}=e;return(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("span",{className:"block text-sm mb-1",children:t}),(0,a.jsx)("input",{type:"number",className:"w-full border rounded px-3 py-2",value:s||0,onChange:e=>l(parseFloat(e.target.value||"0"))})]})}function L(e){let{label:t,v:s,set:l}=e;return(0,a.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:s,onChange:e=>l(e.target.checked)}),(0,a.jsx)("span",{children:t})]})}function E(e){let{onBack:t,onNext:s}=e;return(0,a.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,a.jsx)("button",{type:"button",className:"rounded border px-3 py-2",onClick:t,children:"Back"}),(0,a.jsx)("button",{type:"button",className:"rounded bg-black text-white px-4 py-2",onClick:s,children:"Continue"})]})}let B=e=>"number"==typeof e&&isFinite(e)?e:0,O=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.reduce((e,t)=>e+B(t),0)},V=e=>e.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),U={single:14600,married_joint:29200,married_separate:14600,head:21900};function Y(e){var t,s,a;let l=O(e.salary,e.bonus,e.selfEmployment,e.rsuVesting,e.k1Active,e.k1Passive,e.otherIncome,e.rentNOI),n=12*B(e.fixedMonthlySpend)+12*B(e.lifestyleMonthlySpend),i=Math.max(0,l-n),r=(e.properties||[]).reduce((e,t)=>e+(B(t.estimatedValue)-B(t.mortgageBalance)),0),o=B(null===(t=e.alts)||void 0===t?void 0:t.privateEquityVC)+B(null===(s=e.alts)||void 0===s?void 0:s.collectibles)+B(null===(a=e.alts)||void 0===a?void 0:a.other),d=O(e.cash,e.brokerage,e.retirement,e.hsa,e.crypto,r,o),c=O(e.mortgageDebt,e.studentLoans,e.autoLoans,e.creditCards,e.otherDebt),u=Math.max(3,B(e.emergencyFundMonths)),h=Math.max(1e3,B(e.fixedMonthlySpend)+B(e.lifestyleMonthlySpend)),m=h*u,p=h>0?B(e.cash)/h:0,x=m>0?Math.min(100,B(e.cash)/m*100):0;return{grossIncome:l,spendAnnual:n,impliedSavings:i,savingsRate:l>0?i/l*100:0,totalAssets:d,totalDebts:c,netWorth:d-c,ef:{targetEFMonths:u,monthlyBurn:h,efTarget:m,efCoverageMonths:p,efPct:x}}}function H(e){var t,s,a,l;let n=e.discovery||{},i=(Array.isArray(e.goals5y)?e.goals5y:n.goals5)||[],r=(Array.isArray(e.goals20y)?e.goals20y:n.goals20)||[],o=null!==(s=null!==(t=e.freedomDef)&&void 0!==t?t:n.freedom)&&void 0!==s?s:"",d=Number.isFinite(e.confidence)?e.confidence:null!==(a=n.confidence)&&void 0!==a?a:5,{grossIncome:c,spendAnnual:u,impliedSavings:h,savingsRate:m,netWorth:p}=Y(e),x=null!==(l=U[e.filingStatus])&&void 0!==l?l:U.single,g=!!e.itemizeLikely,b=c>23e4&&"married_joint"===e.filingStatus||c>146e3&&"married_joint"!==e.filingStatus,y=[d>=8?"You’re confident—lean into compounding, while covering tail risks.":d<=4?"Since confidence is lower, bias to liquidity and resilience as we build momentum.":"Solid. We’ll balance growth with safety and cash flexibility.","Snapshot: income ".concat(V(c),"/yr; spend ").concat(V(u),"/yr ⇒ implied savings ").concat(V(h)," (").concat(Math.round(m),"%). Net worth ").concat(V(p),".")],{ef:v}=Y(e),j=Math.max(0,v.efTarget-B(e.cash));if(j>0?y.push("Raise emergency fund to ~".concat(v.targetEFMonths," months (").concat(V(v.efTarget),"). Autotransfer ~").concat(V(Math.ceil(j/12)),"/mo to HYSA/T-bills.")):y.push("Emergency fund ok (~".concat(v.targetEFMonths," months). Keep it in HYSA/T-bill ladder for yield without losing liquidity.")),m<20){let e=Math.ceil((.2*c-h)/12);y.push(e>0?"Increase savings rate toward 20–30%: bump automated transfers by ~".concat(V(e),"/mo (pay-yourself-first)."):"Increase savings rate toward 20–30% via automatic bumps after raises/bonuses.")}else m>=30&&y.push("Excellent savings discipline (~".concat(Math.round(m),"%). Set a 1% auto-increase each year."));let f=Math.max(0,23e3-Math.min(23e3,B(e.retirement)));if(f>0&&y.push("If not already maxing, target employee 401(k) limit (~".concat(V(23e3),"). Increase payroll deferrals by ~").concat(V(Math.ceil(f/12)),"/mo.")),y.push("Max tax-advantaged space: 401(k)/403(b), IRA/backdoor Roth (if needed), HSA if eligible."),b&&!e.usingRothBackdoor&&y.push("Income likely above direct Roth limits; consider a backdoor Roth (watch the pro-rata rule)."),e.usingMegaBackdoor&&y.push("Using a mega-backdoor Roth—great. Confirm plan rules and avoid after-tax leakage."),B(e.rsuVesting)>0){let t=.12999999999999998*B(e.rsuVesting);y.push(t>0?"RSUs: plans often withhold ~".concat(Math.round(22),"%. At your bracket, set aside ~").concat(V(t)," more across vests. Consider 10b5-1 and diversify concentration."):"RSUs: verify withholding and consider a 10b5-1/diversify plan to manage risk and taxes.")}if(e.creditCards>0&&y.push("Attack credit cards first (avalanche). Automate extra above minimums until paid off."),e.studentLoans+e.autoLoans>0&&y.push("After high-interest debt, target student/auto loans while keeping retirement contributions on track."),y.push("If mortgage rate > your safe after-tax yield, add modest extra principal payments after savings goals are met."),(g||e.charitableInclination)&&y.push("Itemized vs standard: compare to ~".concat(V(x)," annually (SALT cap applies). Consider charitable “bunching” or a DAF in high-income years.")),e.hasDisability||y.push("Add long-term disability insurance (top income-protection priority)."),e.hasTermLife||y.push("If others rely on your income, add term life (often 20–30\xd7 annual expenses)."),e.hasUmbrella||y.push("Add a $1–$2M umbrella liability policy; it’s inexpensive and high impact."),e.concentrationRisk&&y.push("Reduce concentration risk via target weights and scheduled auto-sells on any excess."),e.targetRetireIncomeMonthly>0){let t=12*B(e.targetRetireIncomeMonthly);y.push("Retirement income target ~".concat(V(t),"/yr ⇒ long-run portfolio ~").concat(V(t/.04)," (4% proxy). Adjust for pensions, rentals, or early retirement."))}e.hasWillOrTrust?y.push("Review will/trust every 3–5 years and after major life events. Add POA/healthcare directives."):y.push("Create a will and (if appropriate) a revocable living trust. Add POA/healthcare directives.");let N=i.filter(Boolean).slice(0,3),k=r.filter(Boolean).slice(0,3);return N.length&&y.push("Near-term goals: ".concat(N.join(" \xb7 "),".")),k.length&&y.push("Long-term goals: ".concat(k.join(" \xb7 "),".")),o&&y.push("“Financial freedom” (your words): ".concat(o)),y.push("Set a 12-month roadmap: automate transfers, schedule quarterly reviews, and rebalance annually."),y}let W=e=>"number"==typeof e&&isFinite(e)?e:0;function $(e){let{value:t,onChange:s}=e,[n,i]=l.useState({}),r={...t,...n},o=(e,a)=>{i(t=>({...t,[e]:a})),s&&s({...t,[e]:a})},d=l.useMemo(()=>{let e=H(r);return Array.isArray(e)?e.filter(Boolean):[]},[r]);return(0,a.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"What-If (quick tweaks)"}),Object.keys(n).length>0&&(0,a.jsx)("button",{type:"button",onClick:()=>i({}),className:"text-xs underline text-gray-600 hover:text-gray-800",children:"Reset"})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-4",children:"Adjust a few levers and see the plan update instantly. These don’t overwrite your saved inputs unless you’re on the main steps."}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(q,{label:"Salary ($/yr)",children:(0,a.jsx)(_,{value:W(r.salary),onChange:e=>o("salary",e)})}),(0,a.jsx)(q,{label:"Bonus ($/yr)",children:(0,a.jsx)(_,{value:W(r.bonus),onChange:e=>o("bonus",e)})}),(0,a.jsx)(q,{label:"RSU vesting ($/yr)",children:(0,a.jsx)(_,{value:W(r.rsuVesting),onChange:e=>o("rsuVesting",e)})}),(0,a.jsx)(q,{label:"Rent NOI ($/yr)",children:(0,a.jsx)(_,{value:W(r.rentNOI),onChange:e=>o("rentNOI",e)})}),(0,a.jsx)(q,{label:"Fixed spend ($/mo)",children:(0,a.jsx)(_,{value:W(r.fixedMonthlySpend),onChange:e=>o("fixedMonthlySpend",e)})}),(0,a.jsx)(q,{label:"Lifestyle spend ($/mo)",children:(0,a.jsx)(_,{value:r.lifestyleMonthlySpend,onChange:e=>o("lifestyleMonthlySpend",e)})}),(0,a.jsx)(q,{label:"Cash / HYSA ($)",children:(0,a.jsx)(_,{value:r.cash,onChange:e=>o("cash",e)})}),(0,a.jsx)(q,{label:"Retirement (401k/IRA) ($)",children:(0,a.jsx)(_,{value:r.retirement,onChange:e=>o("retirement",e)})})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsxs)("details",{children:[(0,a.jsx)("summary",{className:"cursor-pointer text-sm underline",children:"Previewed recommendations"}),0===d.length?(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"No changes reflected yet."}):(0,a.jsx)("ul",{className:"list-disc ml-5 mt-2 space-y-1 text-sm",children:d.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]})})]})}function q(e){let{label:t,children:s}=e;return(0,a.jsxs)("label",{className:"block text-sm",children:[(0,a.jsx)("span",{className:"block text-[12px] text-gray-600 mb-1",children:t}),s]})}function _(e){let{value:t,onChange:s,step:l=100}=e;return(0,a.jsx)("input",{type:"number",inputMode:"decimal",className:"w-full border rounded px-2 py-1",min:0,step:l,value:W(t),onChange:e=>{let t=Number(e.target.value);s(Number.isFinite(t)?t:0)}})}function z(e){let{input:t,className:s=""}=e,[n,i]=l.useState(!1),[r,o]=l.useState(!1),[d,c]=l.useState(""),u=async()=>{o(!0);try{let e=await fetch("/api/plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:t,wantNarrative:!0})}),s=await e.json();c((null==s?void 0:s.narrative)||"No narrative available."),i(!0)}finally{o(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{type:"button",className:"inline-flex items-center px-3 py-2 rounded border hover:bg-gray-50 ".concat(s),onClick:u,disabled:r,children:r?"Generating…":"View Narrative Summary"}),n&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:()=>i(!1)}),(0,a.jsxs)("div",{className:"relative max-w-3xl w-[92vw] bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg",children:"Narrative Summary"}),(0,a.jsx)("button",{onClick:()=>i(!1),className:"text-gray-600 hover:opacity-80",children:"✕"})]}),(0,a.jsx)("div",{className:"prose max-w-none text-sm whitespace-pre-wrap",children:d})]})]})]})}let G=e=>"number"==typeof e&&isFinite(e)?e:0,K=e=>"".concat(e,"-").concat(Math.random().toString(36).slice(2,9)),J=e=>Math.max(0,Math.min(1,e));function Q(e,t,s){let a=e;return"High"===t&&(a-=.5),"Low"===t&&(a+=.5),"High"===s&&(a+=.5),"Low"===s&&(a-=.25),Math.max(1,Math.min(5,Math.round(a)))}let X=e=>"number"==typeof e&&isFinite(e)?e:0,Z=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.reduce((e,t)=>e+X(t),0)},ee=e=>e.toLocaleString("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0});function et(e){var t,s,n,i,r;let{value:o,onBack:d}=e,c=Z(o.salary,o.bonus,o.selfEmployment,o.rsuVesting,o.k1Active,o.k1Passive,o.otherIncome,o.rentNOI),u=12*X(o.fixedMonthlySpend)+12*X(o.lifestyleMonthlySpend),h=Math.max(0,c-u),m=c>0?h/c*100:0,p=(o.properties||[]).reduce((e,t)=>e+(X(t.estimatedValue)-X(t.mortgageBalance)),0),x=X(null===(t=o.alts)||void 0===t?void 0:t.privateEquityVC)+X(null===(s=o.alts)||void 0===s?void 0:s.collectibles)+X(null===(n=o.alts)||void 0===n?void 0:n.other),g=Z(o.cash,o.brokerage,o.retirement,o.hsa,o.crypto,p,x),b=Z(o.mortgageDebt,o.studentLoans,o.autoLoans,o.creditCards,o.otherDebt),y=Math.max(3,X(o.emergencyFundMonths)),v=Math.max(1e3,X(o.fixedMonthlySpend)+X(o.lifestyleMonthlySpend)),j=v*y,f=v>0?X(o.cash)/v:0,N=j>0?Math.min(100,X(o.cash)/j*100):0,k=l.useMemo(()=>H(o),[o]),C={cash:[],invest:[],debt:[],risk:[],tax:[],estate:[],goals:[],other:[]};k.forEach(e=>{let t=e.toLowerCase();/(emergency|hysa|t-?bill|cash)/.test(t)?C.cash.push(e):/(401|ira|roth|invest|portfolio|rebalance|diversif)/.test(t)?C.invest.push(e):/(debt|credit card|loan|mortgage|principal)/.test(t)?C.debt.push(e):/(disability|term life|umbrella|insurance|risk)/.test(t)?C.risk.push(e):/(tax|charit|itemiz|da?f|withhold)/.test(t)?C.tax.push(e):/(will|trust|estate|inherit)/.test(t)?C.estate.push(e):/(goal|freedom|roadmap)/.test(t)?C.goals.push(e):C.other.push(e)});let S=l.useMemo(()=>k.map(e=>{let t=e.toLowerCase(),s=0;return/increase emergency fund|credit card|under-?withhold|umbrella|disability/.test(t)&&(s+=3),/max|backdoor|roth|mega/.test(t)&&(s+=2),/snapshot|implied savings/.test(t)&&(s+=1),/consider/.test(t)&&(s-=.5),{r:e,score:s}}).sort((e,t)=>t.score-e.score).slice(0,3).map(e=>e.r),[k]),w=l.useMemo(()=>(function(e){let t=Object.fromEntries([function(e){let t=Math.max(1e3,G(e.fixedMonthlySpend)+G(e.lifestyleMonthlySpend)),s=Math.max(3,G(e.emergencyFundMonths)),a=Math.max(0,t*s-G(e.cash));return{id:"emergencyFund",label:"Emergency fund gap",inputs:{monthlyBurn:t,monthsTarget:s,cash:G(e.cash)},result:a,note:"Target cash cushion to cover essential spending without selling investments at a bad time."}}(e),function(e){let t=G(e.rsuVesting);return t<=0?{id:"rsuWithholdingGap",label:"RSU withholding gap",inputs:{rsuYear:t},result:0,note:"No RSU vests expected this year."}:{id:"rsuWithholdingGap",label:"RSU withholding gap",inputs:{rsuYear:t,defaultWH:.22,plausibleRate:.35},result:.12999999999999998*t,note:"Plans often under-withhold on RSU vests vs. your true marginal rate."}}(e),function(e){let t=[e.salary,e.bonus,e.selfEmployment,e.rsuVesting,e.k1Active,e.k1Passive,e.otherIncome,e.rentNOI].map(G).reduce((e,t)=>e+t,0),s=(G(e.fixedMonthlySpend)+G(e.lifestyleMonthlySpend))*12,a=Math.max(0,t-s);return{id:"savingsRate",label:"Savings rate",inputs:{income:t,spend:s,implied:a},result:t>0?a/t:0,note:"Rule-of-thumb target is 20–30% for high earners; higher if retiring early."}}(e)].map(e=>[e.id,e])),s=[...function(e,t){var s;let a=null===(s=t.emergencyFund)||void 0===s?void 0:s.result;return!a||a<=0?[]:[{id:K("cash-ef"),title:"Auto-move ~$".concat(Math.ceil(a/12).toLocaleString()," / mo to HYSA/T-bills until cushion reached"),bucket:"Cash",priority:Q(2,"High","Low"),timeframe:"This month",effort:"Low",impact:"High",rationale:"Build resilience so market dips or job risk dont force selling assets.",calcRefs:["emergencyFund"],estDollars:{oneTimeCostOrFunding:a},links:[{label:"Where to find: bank balance + monthly spend",href:"#"}],toggles:["Pay-yourself-first"]}]}(0,t),...function(e,t){var s;let a=null===(s=t.rsuWithholdingGap)||void 0===s?void 0:s.result;return!a||a<=0?[]:[{id:K("tax-rsu"),title:"Increase tax set-aside for RSU vests by ~$".concat(Math.round(a/4).toLocaleString()," per vest"),bucket:"Taxes",priority:Q(3,"High","Low"),timeframe:"This quarter",effort:"Low",impact:"High",rationale:"Avoid April surprise from under-withheld supplemental wages.",calcRefs:["rsuWithholdingGap"],estDollars:{annualTaxSavings:0,oneTimeCostOrFunding:a},links:[{label:"Where to find: vesting schedule & paystubs",href:"#"}],toggles:["Assume 35% marginal vs 22% withheld"]},{id:K("invest-concentration"),title:"Set a 10b5-1 or scheduled auto-sell to manage concentration",bucket:"Investing",priority:Q(3,"Medium","Medium"),timeframe:"This quarter",effort:"Medium",impact:"Medium",rationale:"Reduce single-stock risk while staying disciplined.",calcRefs:["rsuWithholdingGap"]}]}(0,t),...function(e,t){var s,a,l,n,i;let r=J(null!==(n=null===(s=t.savingsRate)||void 0===s?void 0:s.result)&&void 0!==n?n:0);if(r>=.2)return[];let o=Math.ceil((.2-r)*(null!==(i=null===(l=t.savingsRate)||void 0===l?void 0:null===(a=l.inputs)||void 0===a?void 0:a.income)&&void 0!==i?i:0)/12);return[{id:K("cash-savingsrate"),title:"Raise auto-transfers by ~$".concat(o.toLocaleString()," / mo to hit 20% savings"),bucket:"Cash",priority:Q(2,"High","Low"),timeframe:"This month",effort:"Low",impact:"High",rationale:"Pay-yourself-first enforces the plan without decision fatigue.",calcRefs:["savingsRate"],estDollars:{annualCashFlowChange:12*o}}]}(0,t),{id:K("invest-401k"),title:"Confirm 401(k) deferral will reach the annual employee limit",bucket:"Investing",priority:Q(3,"Medium","Low"),timeframe:"This month",effort:"Low",impact:"Medium",rationale:"Shelter more income; adjust payroll % after raises/bonuses.",links:[{label:"Where to find: benefits portal > contributions",href:"#"}]}];s=s.map(e=>({...e,priority:Q(3,e.impact,e.effort)}));let a={"This week":0,"This month":1,"This quarter":2,"This year":3};s.sort((e,t)=>e.priority-t.priority||a[e.timeframe]-a[t.timeframe]);let l={"This week":[],"This month":[],"This quarter":[],"This year":[]};for(let e of s){let t=l[e.timeframe];t.length<5&&t.push(e)}let n={},i=[];for(let e of["This week","This month","This quarter","This year"]){let t=l[e].map(e=>(n[e.id]=e,e.id));t.length&&i.push({title:e,actions:t})}return{generatedAt:new Date().toISOString(),actions:n,checklists:i,traces:t}})(o),[o]),{weekActions:M,monthActions:R,quarterActions:A}=l.useMemo(()=>{let e=[],t=[],s=[];C.cash.length&&(e.push("Open/confirm HYSA or T-bill account"),e.push("Set up auto-transfer on payday for emergency fund"),t.push("Validate emergency fund target and adjust transfer amount")),C.tax.length&&(e.push("Turn on paycheck “additional withholding” or RSU tax set-aside"),t.push("Run itemized vs standard deduction check for this year"),s.push("Quarterly: review RSU withholding set-aside vs vests")),C.invest.length&&(e.push("Set target allocation and auto-invest schedule"),t.push("Enroll 1% annual auto-increase on 401(k) deferral"),s.push("Rebalance and harvest losses/gains as appropriate")),C.debt.length&&(e.push("List all debts with APR and minimums"),t.push("Start avalanche payments on highest-APR debt"),s.push("If mortgage & cash allow, add small extra principal monthly")),C.risk.length&&(e.push("Get quotes: disability, term life, umbrella"),t.push("Bind umbrella policy ($1–2M)")),C.estate.length&&(e.push("List beneficiaries on 401k/IRA/HSA and life insurance"),t.push("Schedule will/trust consult; add POA/health directives"));let a=(e,t)=>Array.from(new Set(e)).slice(0,t);return{weekActions:a(e,5),monthActions:a(t,6),quarterActions:a(s,6)}},[C]);return(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"rounded-lg border p-4 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Review & Finalize"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Here’s a first pass of your plan. Tweak inputs on the right—numbers and recommendations update live. You can generate a written narrative any time."}),(0,a.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2 text-sm",children:[(0,a.jsxs)(es,{children:["Income ",ee(c),"/yr"]}),(0,a.jsxs)(es,{children:["Spend ",ee(u),"/yr"]}),(0,a.jsxs)(es,{children:["Savings ",ee(h)," (",Math.round(m),"%)"]}),(0,a.jsxs)(es,{children:["Net worth ",ee(g-b)]})]}),(0,a.jsxs)("div",{className:"mt-4 grid sm:grid-cols-2 gap-4",children:[(0,a.jsx)(ea,{label:"Emergency Fund Coverage",hint:"".concat(Math.max(0,Math.floor(f))," / ").concat(y," months"),percent:N}),(0,a.jsx)(ea,{label:"Savings Rate",hint:"".concat(Math.round(m),"% (target 20–30%)"),percent:Math.max(0,Math.min(100,m))})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border p-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Your Action Plan"}),(0,a.jsx)(z,{input:o,className:"text-sm underline px-2 py-1 rounded hover:bg-gray-50"})]}),(null==w?void 0:null===(i=w.flags)||void 0===i?void 0:i.length)?(0,a.jsx)("div",{className:"mt-2 text-sm text-amber-700",children:w.flags.map((e,t)=>(0,a.jsxs)("div",{children:["• ",e]},t))}):null,(0,a.jsx)("div",{className:"mt-4 grid md:grid-cols-2 gap-4",children:null==w?void 0:null===(r=w.checklists)||void 0===r?void 0:r.map(e=>(0,a.jsxs)("div",{className:"rounded border p-3",children:[(0,a.jsx)("div",{className:"font-medium mb-2",children:e.title}),(0,a.jsx)("ul",{className:"space-y-2",children:e.actions.map(e=>{var t;let s=w.actions[e];return s?(0,a.jsxs)("li",{className:"text-sm",children:[(0,a.jsx)("div",{className:"font-medium",children:s.title}),(0,a.jsxs)("div",{className:"text-gray-600",children:[(0,a.jsxs)("span",{className:"mr-2",children:["Impact: ",s.impact]}),(0,a.jsxs)("span",{className:"mr-2",children:["Effort: ",s.effort]}),(0,a.jsxs)("span",{children:["Bucket: ",s.bucket]})]}),s.estDollars&&(0,a.jsxs)("div",{className:"text-gray-600",children:[s.estDollars.annualTaxSavings?"Est. tax save: $".concat(s.estDollars.annualTaxSavings.toLocaleString()," "):"",s.estDollars.annualCashFlowChange?"Cash flow: $".concat(s.estDollars.annualCashFlowChange.toLocaleString(),"/yr "):"",s.estDollars.oneTimeCostOrFunding?"Funding: $".concat(s.estDollars.oneTimeCostOrFunding.toLocaleString()," "):""]}),(0,a.jsx)("div",{className:"text-gray-700 mt-1",children:s.rationale}),(null===(t=s.calcRefs)||void 0===t?void 0:t.length)?(0,a.jsxs)("details",{className:"mt-1",children:[(0,a.jsx)("summary",{className:"cursor-pointer text-xs underline",children:"Why this?"}),(0,a.jsx)("div",{className:"mt-1 text-xs text-gray-700 space-y-1",children:s.calcRefs.map(e=>{var t;let s=null===(t=w.traces)||void 0===t?void 0:t[e];return s?(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:s.label}),s.note&&(0,a.jsx)("div",{children:s.note}),"result"in s&&void 0!==s.result&&(0,a.jsxs)("div",{children:["Result:"," ","number"==typeof s.result?"$".concat(s.result.toLocaleString()):String(s.result)]})]},e):null})})]}):null]},e):null})})]},e.title))})]}),(0,a.jsxs)("div",{className:"rounded-lg border p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"\uD83D\uDE80 Your Top 3 Priorities"}),(0,a.jsx)("ol",{className:"list-decimal ml-5 space-y-2",children:S.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}),(0,a.jsx)(en,{title:"This Week",items:M.length?M:["Set up HYSA auto-transfer","List debts with APRs","Pick a 401(k) target allocation"]}),(0,a.jsx)(en,{title:"Next 30 Days",items:R.length?R:S}),(0,a.jsx)(en,{title:"Next 90 Days",items:A.length?A:["Rebalance portfolio","Quarterly: check RSU set-aside vs. vests."]}),(0,a.jsx)(el,{title:"\uD83D\uDCB0 Cash & Savings",items:C.cash,defaultOpen:!0}),(0,a.jsx)(el,{title:"\uD83D\uDCC8 Investing & Retirement",items:C.invest}),(0,a.jsx)(el,{title:"\uD83C\uDFE1 Debt & Real Estate",items:C.debt}),(0,a.jsx)(el,{title:"\uD83D\uDEE1️ Risk Protection",items:C.risk}),(0,a.jsx)(el,{title:"\uD83E\uDDFE Taxes & Charitable",items:C.tax}),(0,a.jsx)(el,{title:"⚖️ Estate & Legacy",items:C.estate}),(0,a.jsx)(el,{title:"\uD83C\uDFAF Your Goals",items:C.goals}),C.other.length>0&&(0,a.jsx)(el,{title:"\uD83E\uDDE9 Other",items:C.other}),(0,a.jsxs)("div",{className:"mt-6 flex flex-wrap items-center gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:d,className:"rounded border px-4 py-2 hover:bg-gray-50",children:"Back"}),(0,a.jsx)("button",{type:"submit",className:"inline-flex items-center px-4 py-2 rounded bg-black text-white hover:opacity-90",children:"Generate Final Plan"})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)($,{value:o})})]})}function es(e){let{children:t}=e;return(0,a.jsx)("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-white",children:t})}function ea(e){let{label:t,hint:s,percent:l}=e;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"font-medium",children:t}),s&&(0,a.jsx)("span",{className:"text-gray-600",children:s})]}),(0,a.jsx)("div",{className:"h-2 w-full rounded bg-gray-200 overflow-hidden",children:(0,a.jsx)("div",{className:"h-2 rounded bg-black transition-all",style:{width:"".concat(Math.max(0,Math.min(100,l)),"%")}})})]})}function el(e){let{title:t,items:s,defaultOpen:n=!1}=e;if(!s||0===s.length)return null;let[i,r]=l.useState(n);return(0,a.jsxs)("div",{className:"rounded-lg border mb-3",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>r(e=>!e),className:"w-full px-4 py-3 text-left flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium",children:t}),(0,a.jsx)("span",{className:"text-gray-500",children:i?"−":"+"})]}),i&&(0,a.jsx)("div",{className:"px-5 pb-4",children:(0,a.jsx)("ul",{className:"list-disc ml-5 space-y-2",children:s.map((e,t)=>(0,a.jsx)("li",{children:e},t))})})]})}function en(e){let{title:t,items:s}=e;return s&&0!==s.length?(0,a.jsxs)("div",{className:"rounded-lg border p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:t}),(0,a.jsx)("ul",{className:"list-disc ml-5 space-y-2",children:s.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}):null}function ei(){let[e,t]=(0,l.useState)(n),[s,i]=(0,l.useState)(1),[o,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)(null),[m,p]=(0,l.useState)(null),x=()=>i(e=>Math.min(8,e+1)),b=()=>i(e=>Math.max(1,e-1));async function y(t){if(t.preventDefault(),!(s<8)){d(!0),p(null),h(null);try{let t=await fetch("/api/plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text());let s=await t.json();h(Array.isArray(null==s?void 0:s.recommendations)?s.recommendations:[]),requestAnimationFrame(()=>{var e;null===(e=document.getElementById("results"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"})})}catch(e){p((null==e?void 0:e.message)||"Failed to generate plan.")}finally{d(!1)}}}return(0,a.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Step ",s," of 8"]}),(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Financial Planner"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"We’ll ask only what’s needed—no sensitive identifiers."})]}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[1===s&&(0,a.jsx)(r,{value:e,onChange:t,onNext:x}),2===s&&(0,a.jsx)(c,{value:e,onChange:t,onNext:x,onBack:b}),3===s&&(0,a.jsx)(g,{value:e,onChange:t,onNext:x,onBack:b}),4===s&&(0,a.jsx)(j,{value:e,onChange:t,onNext:x,onBack:b}),5===s&&(0,a.jsx)(S,{value:e,onChange:t,onNext:x,onBack:b}),6===s&&(0,a.jsx)(A,{value:e,onChange:t,onNext:x,onBack:b}),7===s&&(0,a.jsx)(F,{value:e,onChange:t,onNext:x,onBack:b}),8===s&&(0,a.jsx)(et,{value:e,onBack:b})]}),o&&(0,a.jsx)("p",{className:"mt-6",children:"Generating plan…"}),m&&(0,a.jsx)("div",{className:"mt-6 rounded border border-red-300 bg-red-50 p-3 text-red-800",children:m}),u&&(0,a.jsxs)("section",{id:"results",className:"mt-8 rounded border p-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Personalized Recommendations"}),0===u.length?(0,a.jsx)("p",{children:"No recommendations returned."}):(0,a.jsx)("ul",{className:"list-disc pl-5 space-y-2",children:u.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=8546)}),_N_E=e.O()}]);